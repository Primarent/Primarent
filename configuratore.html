<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Configuratore - Primarent</title>

<link rel="stylesheet" href="style.css" />

<style>
/* --- STILI LOCALI --- */
.container-config {
  max-width: 1000px;
  margin: 40px auto;
  padding: 20px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 6px 30px rgba(0,0,0,0.08);
  color: #1C1C1C;
}
.steps { display: flex; gap: 12px; justify-content: center; margin-bottom: 20px; flex-wrap: wrap; }
.step-pill { padding: 8px 14px; border-radius: 20px; background: #f0f0f0; font-weight: 600; }
.step-pill.active { background: var(--accent); color: white; }

.cars-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 18px; margin-top: 16px; }
.car-card { border-radius: 10px; overflow: hidden; background: #fafafa; box-shadow: 0 3px 12px rgba(0,0,0,0.06); display: flex; flex-direction: column; }
.car-card img { width: 100%; height: 160px; object-fit: cover; }
.car-card .card-body { padding: 14px; flex: 1; display: flex; flex-direction: column; gap: 8px; }
.car-card h3 { margin: 0; font-size: 18px; }
.car-card p { margin: 0; color: #555; font-size: 14px; }

.big-price { font-size: 28px; font-weight: 900; color: var(--accent); }
.option { background: #fff; padding: 12px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.04); }

.summary {
  margin-top: 18px;
  padding: 14px;
  border-radius: 10px;
  background: #f7f7f7;
  font-size: 18px;
  display: flex;
  gap: 14px;
  align-items: center;
  justify-content: space-between;
}

@media (max-width: 700px){
  .container-config { margin: 20px; padding: 12px; }
  .car-card img { height: 140px; }
  .summary { flex-direction: column; align-items: flex-start; gap: 8px; }
}
</style>
</head>

<body>

<header class="navbar">
  <img src="logo.png" alt="Primarent Logo" class="nav-logo">
  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="promo.html">Offerte</a></li>
      <li><a href="chi-siamo.html">Chi Siamo</a></li>
      <li><a href="contatti.html">Contatti</a></li>
      <li><a href="configuratore.html" class="cta">Configura</a></li>
    </ul>
  </nav>
</header>

<main class="container-config">

<!-- STEP INDICATOR -->
<div style="text-align:center; margin-bottom:8px;">
  <h1 style="margin:0 0 6px 0;">Configuratore Offerta</h1>
  <p style="margin:0;color:#666;">Scegli il modello e personalizza — il prezzo si aggiorna in tempo reale.</p>
</div>

<div class="steps">
  <div class="step-pill active" id="pill-1">1. Seleziona Auto</div>
  <div class="step-pill" id="pill-2">2. Personalizza</div>
  <div class="step-pill" id="pill-3">3. Riepilogo</div>
  <div class="step-pill" id="pill-4">4. Richiesta</div>
</div>

<!-- STEP 1 -->
<div id="step1">
  <div class="cars-grid" id="carsGrid"></div>
</div>

<!-- STEP 2 -->
<div id="step2" style="display:none;">
  <h2>Personalizza il tuo contratto</h2>

  <div class="options-grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;">
    
    <div class="option">
      <strong>Durata (mesi)</strong><br>
      <select id="durata">
        <option value="24">24</option>
        <option value="36" selected>36</option>
        <option value="48">48</option>
        <option value="60">60</option>
      </select>
    </div>

    <div class="option">
      <strong>Km annui</strong><br>
      <select id="km">
        <option value="10000">10.000 km</option>
        <option value="15000">15.000 km</option>
        <option value="20000" selected>20.000 km</option>
        <option value="25000">25.000 km</option>
      </select>
    </div>

    <div class="option">
      <strong>Servizi aggiuntivi</strong><br>
      <label><input type="checkbox" class="srv" value="10"> Manutenzione (+10€)</label><br>
      <label><input type="checkbox" class="srv" value="20"> Assicurazione Kasko (+20€)</label><br>
      <label><input type="checkbox" class="srv" value="15"> Pneumatici (+15€)</label><br>
      <label><input type="checkbox" class="srv" value="8"> Vettura sostitutiva (+8€)</label>
    </div>

    <div class="option">
      <strong>Accessori</strong><br>
      <label><input type="checkbox" class="access" value="5"> Portapacchi (+5€)</label><br>
      <label><input type="checkbox" class="access" value="7"> Navigatore (+7€)</label><br>
      <label><input type="checkbox" class="access" value="6"> Telepass (+6€)</label>
    </div>
  </div>

  <div class="summary">
    <div class="left">
      <div id="selCarName" style="font-weight:700;">Seleziona un'auto</div>
      <div id="selCarMeta" style="color:#666;font-size:14px;">Per vedere il prezzo</div>
    </div>
    <div class="right">
      <div class="big-price" id="partialPrice">€0 /mese</div>
    </div>
  </div>

  <div style="text-align:right;margin-top:14px;">
    <button class="btn" onclick="backToStep1()">← Modifica auto</button>
    <button class="btn" onclick="toStep3()" style="background:var(--accent);">Continua →</button>
  </div>
</div>

<!-- STEP 3 -->
<div id="step3" style="display:none;">
  <h2>Riepilogo offerta</h2>

  <div style="display:flex;gap:16px;flex-wrap:wrap;align-items:center;">
    <img id="recapImg" src="" style="width:220px;height:140px;object-fit:cover;border-radius:8px;">
    
    <div style="flex:1;">
      <h3 id="recapName"></h3>
      <p id="recapMeta" style="color:#666;"></p>
      <div id="recapServices"></div>
    </div>

    <div>
      <div style="font-size:14px;color:#666;">Canone stimato</div>
      <div class="big-price" id="recapPrice">€0 /mese</div>
    </div>
  </div>

  <div style="text-align:right;margin-top:18px;">
    <button class="btn" onclick="backToStep2()">← Indietro</button>
    <button class="btn" onclick="toStep4()" style="background:var(--accent);">Richiedi Preventivo →</button>
  </div>
</div>

<!-- STEP 4 -->
<div id="step4" style="display:none;">
  <h2>Richiedi il preventivo</h2>

  <div style="max-width:700px;margin:auto;">
    <label>Nome</label><br>
    <input id="userName" style="width:100%;padding:10px;margin-bottom:8px;">

    <label>Telefono</label><br>
    <input id="userPhone" style="width:100%;padding:10px;margin-bottom:8px;">

    <label>Email</label><br>
    <input id="userEmail" style="width:100%;padding:10px;margin-bottom:8px;">

    <label>Note (opzionale)</label><br>
    <textarea id="userNote" style="width:100%;padding:10px;margin-bottom:8px;"></textarea>

    <div style="text-align:right;">
      <button class="btn" onclick="backToStep3()">← Indietro</button>
      <button class="btn" id="sendWhatsapp" style="background:#25D366;">Invia su WhatsApp</button>
    </div>
  </div>
</div>

</main>
<footer style="text-align:center;padding:18px;color:#666;">
© 2025 Primarent.it — Tutti i diritti riservati
</footer>

<script>
/* ============================================================
   DATI AUTO
============================================================ */
const cars = [
  {id:1,name:"Fiat 500 Hybrid",base:199,img:"https://images.unsplash.com/photo-1542362567-b07e54358753?w=1200",desc:"Compatta, urbana e conveniente."},
  {id:2,name:"Jeep Renegade",base:289,img:"https://images.unsplash.com/photo-1503376780353-7e6692767b70?w=1200",desc:"SUV compatto per ogni viaggio."},
  {id:3,name:"Volkswagen Golf",base:329,img:"https://images.unsplash.com/photo-1525609004556-c46c7d6cf023?w=1200",desc:"Affidabile e spaziosa."},
  {id:4,name:"Peugeot 208",base:229,img:"https://images.unsplash.com/photo-1493238792000-8113da705763?w=1200",desc:"Elegante e moderna."}
];

let state = { carId:null, durata:36, km:20000, servizi:[], accessori:[] };

function fmt(v){ return "€"+Number(v).toLocaleString("it-IT"); }

/* ============================================================
   GENERA AUTO
============================================================ */
function renderCars(){
  const grid = document.getElementById("carsGrid");
  grid.innerHTML = "";
  cars.forEach(car=>{
    const div = document.createElement("div");
    div.className="car-card";
    div.innerHTML = `
      <img src="${car.img}">
      <div class="card-body">
        <h3>${car.name}</h3>
        <p>${car.desc}</p>
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <div style="font-weight:800;color:var(--accent);">${fmt(car.base)}/mese</div>
          <button class="btn" onclick="selectCar(${car.id})">Seleziona</button>
        </div>
      </div>`;
    grid.appendChild(div);
  });
}

/* ============================================================
   LOGICA CONFIGURATORE
============================================================ */
function selectCar(id){
  state.carId = id;
  const car = cars.find(c=>c.id===id);
  document.getElementById("selCarName").innerText = car.name;
  document.getElementById("selCarMeta").innerText = car.desc;
  updatePartialPrice();
  showStep(2);
}

function calculatePrice(){
  if(!state.carId) return 0;

  const car = cars.find(c=>c.id===state.carId);
  let price = car.base;

  const kmMul = {10000:0.95,15000:1.0,20000:1.1,25000:1.2};
  const durMul = {24:1.25,36:1.0,48:0.9,60:0.85};

  price = price * (kmMul[state.km]||1) * (durMul[state.durata]||1);

  price += state.servizi.reduce((a,b)=>a+b,0);
  price += state.accessori.reduce((a,b)=>a+b,0);

  return Math.round(price);
}

/* ======== AGGIORNAMENTO AUTOMATICO PREZZO ======== */
function updatePartialPrice(){
  state.durata = Number(document.getElementById("durata").value);
  state.km = Number(document.getElementById("km").value);
  state.servizi = Array.from(document.querySelectorAll(".srv:checked")).map(e=>Number(e.value));
  state.accessori = Array.from(document.querySelectorAll(".access:checked")).map(e=>Number(e.value));
  document.getElementById("partialPrice").innerText = fmt(calculatePrice())+" /mese";
}

/* EVENT LISTENER AUTOMATICI */
document.addEventListener("change", e=>{
  if(e.target.id==="durata" || e.target.id==="km" || e.target.classList.contains("srv") || e.target.classList.contains("access")){
    updatePartialPrice();
  }
});

/* ============================================================
   NAVIGAZIONE DEGLI STEP
============================================================ */
function showStep(n){
  for(let i=1;i<=4;i++){
    document.getElementById("step"+i).style.display = (i===n?"block":"none");
    document.getElementById("pill-"+i).classList.toggle("active",i===n);
  }
}

function toStep3(){
  renderRecap();
  showStep(3);
}
function backToStep2(){ showStep(2); }
function backToStep1(){ showStep(1); }

function toStep4(){ showStep(4); }

/* ============================================================
   RIEPILOGO
============================================================ */
function renderRecap(){
  const car = cars.find(c=>c.id===state.carId);
  document.getElementById("recapImg").src = car.img;
  document.getElementById("recapName").innerText = car.name;
  document.getElementById("recapMeta").innerText =
    `${car.desc} • Durata: ${state.durata} mesi • Km annui: ${state.km}`;
  document.getElementById("recapPrice").innerText =
    fmt(calculatePrice())+" /mese";

  const srv = Array.from(document.querySelectorAll(".srv:checked"))
    .map(n=>n.parentNode.textContent.trim())
    .join(" • ");
  const acc = Array.from(document.querySelectorAll(".access:checked"))
    .map(n=>n.parentNode.textContent.trim())
    .join(" • ");

  let out="";
  if(srv) out += "<strong>Servizi:</strong> "+srv+"<br>";
  if(acc) out += "<strong>Accessori:</strong> "+acc;

  document.getElementById("recapServices").innerHTML = out;
}

/* ============================================================
   WHATSAPP
============================================================ */
document.getElementById("sendWhatsapp").addEventListener("click",function(){
  const car = cars.find(c=>c.id===state.carId);

  const msg = encodeURIComponent(
    "Richiesta Preventivo Primarent\n"+
    "Auto: "+car.name+"\n"+
    "Canone stimato: "+fmt(calculatePrice())+"/mese\n"+
    "Durata: "+state.durata+" mesi\n"+
    "Km annui: "+state.km+"\n"+
    "Cliente: "+document.getElementById("userName").value+"\n"+
    "Telefono: "+document.getElementById("userPhone").value+"\n"+
    "Email: "+document.getElementById("userEmail").value+"\n"+
    "Note: "+document.getElementById("userNote").value
  );

  window.open("https://wa.me/393472486486?text="+msg,"_blank");
});

/* AVVIO */
renderCars();
showStep(1);

</script>
</body>
</html>
